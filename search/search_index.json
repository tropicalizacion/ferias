{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"La feria es el lugar de la variedad, la frescura y los buenos precios","text":"<p>Un proyecto de promoci\u00f3n de las ferias del agricultor de Costa Rica.</p> <ul> <li> Sitio web | deferia.cr</li> <li> Instagram | deferia.cr</li> </ul> <p>Nuestras premisas</p> <ol> <li>El mejor lugar para comprar productos frescos por precio, variedad y frescura es la feria del agricultor.</li> <li>La mejor dieta para la salud est\u00e1 basada en productos frescos.</li> <li>Las ferias benefician econ\u00f3micamente a las comunidades y a las familias, tanto a quienes venden como a quienes compran.</li> <li>Las ferias representan un instrumento efectivo para la seguridad alimentaria y nutricional en el pa\u00eds.</li> <li>Las ferias son espacios sociales y culturales esenciales para Costa Rica, con una tradici\u00f3n de muchas d\u00e9cadas.</li> </ol>"},{"location":"HOWTO/","title":"Habilitar un ambiente de desarrollo con Docker","text":"<p>Este documento describe c\u00f3mo configurar y ejecutar un entorno de desarrollo para <code>deferia.cr</code> utilizando Docker.</p> <p>[!WARNING] Es ideal no saltarse pasos de esta gu\u00eda, y de ser necesario, solicitar ayuda.</p>"},{"location":"HOWTO/#requisitos-previos","title":"Requisitos previos","text":""},{"location":"HOWTO/#windows","title":"Windows","text":"<p>Es necesario tener instalados los siguientes componentes:</p> <ul> <li>Windows Subsystem Linux</li> <li>Docker Desktop</li> <li>Git</li> </ul>"},{"location":"HOWTO/#sistemas-operativos-basados-en-unix-macos-y-distribuciones-de-linux","title":"Sistemas operativos basados en UNIX (MacOS, y distribuciones de Linux)","text":"<p>Es necesario tener instalados los siguientes componentes (se recomienda revisar la documentaci\u00f3n espec\u00edfica del sistema operativo):</p> <ul> <li>Python 3</li> <li>Docker</li> <li>Docker compose</li> <li>Git</li> </ul> <p>[!TIP] Instalar Docker Desktop, incluye el engine de Docker y Docker Compose. Facilita visualizar los contenedores y brinda m\u00faltiples herramientas que pueden ser de utilidad.  </p>"},{"location":"HOWTO/#pasos-a-seguir-previo-a-iniciar-el-contenedor","title":"Pasos a seguir previo a iniciar el contenedor","text":""},{"location":"HOWTO/#1-clonar-el-repositorio","title":"1. Clonar el repositorio","text":"<pre><code>git clone https://github.com/tropicalizacion/ferias.git\n</code></pre>"},{"location":"HOWTO/#2-crear-archivo-de-variables-de-entorno","title":"2. Crear archivo de variables de entorno","text":"<p>Antes de iniciar el entorno, es necesario crear un archivo <code>.env</code> en la ra\u00edz del proyecto. Este archivo contiene variables sensibles como claves secretas y credenciales de base de datos.</p> <p>[!IMPORTANT] El archivo <code>.env</code> no debe subirse al repositorio. Solicite el contenido a otro colaborador del proyecto.</p> <p>[!NOTE] El archivo <code>.env.example</code> tiene los campos que deben ser llenados.</p>"},{"location":"HOWTO/#3-dar-permisos-a-los-scripts","title":"3. Dar permisos a los scripts","text":"<p>Asegurarse que los scripts sean ejecutables:</p> <pre><code>chmod +x ./scripts/*.sh\n</code></pre>"},{"location":"HOWTO/#levantar-el-contenedor-con-el-entorno-de-desarrollo","title":"Levantar el contenedor con el entorno de desarrollo","text":"<p>Seg\u00fan el sistema operativo, hay una distinci\u00f3n muy peque\u00f1a en el comando que se usa.</p>"},{"location":"HOWTO/#windows_1","title":"Windows","text":"<p>Desde una terminal en la ra\u00edz del proyecto, levante el contenedor con el siguiente comando:</p> <pre><code>docker-compose up --build\n</code></pre>"},{"location":"HOWTO/#sistemas-operativos-basados-en-unix-macos-y-distribuciones-de-linux_1","title":"Sistemas operativos basados en UNIX (MacOS, y distribuciones de Linux)","text":"<p>Desde una terminal en la ra\u00edz del proyecto, levante el contenedor con el siguiente comando:</p> <pre><code>docker compose up --build\n</code></pre> <p>Este comando compilar\u00e1 la imagen (si es necesario) y levantar\u00e1 los servicios definidos en el <code>docker-compose.yml</code>. Esto puede tardar varios minutos en ejecutarse.</p>"},{"location":"HOWTO/#migraciones-de-la-base-de-datos","title":"Migraciones de la base de datos","text":"<p>Una vez que el contenedor est\u00e9 corriendo correctamente, en una terminal nueva, ejecutar el script necesario para las migraciones de la base de datos:</p> <pre><code>./scripts/dmigrations.sh\n</code></pre> <p>[!NOTE] Es normal que se muestren varias advertencias durante este proceso</p>"},{"location":"HOWTO/#creacion-de-un-usuario-administrador","title":"Creacion de un usuario administrador","text":"<p>En caso de ser necesario, con el siguiente comando se puede llamar al script que es capaz de crear un usuario administrador para el entorno local:</p> <pre><code>./scripts/superuser.sh\n</code></pre>"},{"location":"HOWTO/#acceso-a-la-aplicacion","title":"Acceso a la aplicaci\u00f3n","text":"<p>Una vez que todo est\u00e9 en funcionamiento, acceda al navegador con la siguiente direcci\u00f3n, que por defecto es el puerto 8000:</p> <pre><code>http://localhost:8000/\n</code></pre>"},{"location":"HOWTO/#ejecucion-de-comandos","title":"Ejecuci\u00f3n de comandos","text":"<p>Como el proyecto se ejecuta por medio de Docker, en vez de usar un ambiente virtual de Python, es necesario realizar los comandos dentro del contenedor.</p> <p>Ejemplo:</p> <p>Para crear un usuario administrador, en un ambiente virtual de Python se usa el comando:</p> <pre><code>python manage.py createsuperuser\n</code></pre> <p>Mientras que en Docker, se usa el comando:</p> <pre><code>docker exec ferias_django_app python manage.py makemigrations\n</code></pre>"},{"location":"HOWTO/#problemas-comunes","title":"Problemas comunes","text":""},{"location":"HOWTO/#el-contenedor-no-inicia-o-falla-en-la-instalacion","title":"El contenedor no inicia o falla en la instalaci\u00f3n","text":"<ul> <li>Verificar que Docker est\u00e9 corriendo correctamente.</li> <li>Asegurarse de que el archivo <code>.env</code> est\u00e9 presente y correctamente configurado.</li> <li>Si se hacen cambios en el <code>Dockerfile</code> o en dependencias, ejecutar:</li> </ul> <pre><code>docker-compose down\ndocker-compose up --build\n</code></pre>"},{"location":"HOWTO/#el-script-dmigrationssh-no-funciona","title":"El script <code>dmigrations.sh</code> no funciona","text":"<ul> <li>Asegurarse de haberle dado permisos de ejecuci\u00f3n:</li> </ul> <pre><code>chmod +x ./scripts/dmigrations.sh\n</code></pre> <ul> <li>Verificar que el contenedor est\u00e9 activo antes de ejecutarlo.</li> </ul>"},{"location":"HOWTO/#otros-comandos-utiles","title":"Otros comandos \u00fatiles","text":""},{"location":"HOWTO/#detener-el-entorno","title":"Detener el entorno","text":"<pre><code>docker-compose down\n</code></pre>"},{"location":"HOWTO/#ver-logs-en-tiempo-real","title":"Ver logs en tiempo real","text":"<pre><code>docker-compose logs -f\n</code></pre>"},{"location":"HOWTO/#abrir-terminal-postgress","title":"Abrir terminal Postgress","text":"<pre><code>docker exec -ti postgres_db psql -U [USUARIO] -d ferias\n</code></pre>"},{"location":"MODELS/","title":"Modelos de la base de datos","text":"<p>Modelos seg\u00fan Django</p>"},{"location":"MODELS/#ferias","title":"Ferias","text":"<ul> <li><code>class Marketplace</code>:</li> <li><code>marketplace_url</code>: (CharField) identificador \u00fanico. Ejemplo: <code>curridabat</code>, <code>sansebastian</code>. Nota: este tambi\u00e9n ser\u00e1 el URL de cada feria, por ejemplo: https://feria.cr/curridabat.</li> <li><code>name</code>: (CharField) nombre com\u00fan de la feria. No debe incluir \"La Feria de...\" y debe estar escrita con la ortograf\u00eda correcta. Ejemplo: Tres R\u00edos.</li> <li><code>name_alternate</code>: (TextField) descripci\u00f3n de la feria.</li> <li><code>description</code>: (CharField)</li> <li><code>opening_hours</code>: (CharField) descripci\u00f3n de los horarios de apertura (seg\u00fan referencia de OpenStreetMaps). Ejemplo: \"Mo-Fr 08:00-12:00,13:00-17:00. Nota: hay que evaluar la mejor forma de adaptar esto a partir de la tabla <code>Calendar</code> m\u00e1s adelante.</li> <li><code>location</code>: (PointField) ubicaci\u00f3n SRID 4326 (WGS84) de la feria (GeoDjango).</li> <li><code>area</code>: (PolygonField) pol\u00edgono que demarca el \u00e1rea o regi\u00f3n donde est\u00e1 la feria (GeoDjango).</li> <li><code>size</code>: (CharField) nuestra propia clasificaci\u00f3n del tama\u00f1o relativo de una feria, con los valores posibles:<ul> <li>S: peque\u00f1a</li> <li>M: mediana</li> <li>L: grande</li> <li>XL: extra grande</li> </ul> </li> <li><code>province</code>: (CharField) divisi\u00f3n provincial de Costa Rica.</li> <li><code>canton</code>: (CharField) divisi\u00f3n cantonal de Costa Rica.</li> <li><code>district</code>: (CharField) divisi\u00f3n distrital de Costa Rica.</li> <li><code>address</code>: (TextField) direcci\u00f3n \"a la tica\". Ejemplo: \"En el gimnasio de la escuela de Guachipel\u00edn\".</li> <li><code>phone</code>: (PhoneNumberField) n\u00famero de tel\u00e9fono (seg\u00fan recomendaci\u00f3n E.164 de UIT). Ejemplo: +50687654321.</li> <li><code>admin_committee</code>: (CharField) comit\u00e9 regional del CNP a la que pertenece la feria.</li> <li><code>admin_center</code>: (CharField) centro agr\u00edcola que administra la feria.</li> <li><code>email</code>: (EmailField) correo electr\u00f3nico de contacto.</li> <li><code>website</code>: (URLField) direcci\u00f3n web de la feria (web, Facebook, etc.)</li> <li><code>products</code>: (ManyToMany) productos regulares en la oferta de la feria, vinculado con la tabla <code>Products</code>.</li> <li>Infraestructura:<ul> <li><code>parking</code>: (CharField)</li> <li><code>bicycle_parking</code>: (BooleanField)</li> <li><code>fairground</code>: (BooleanField)</li> <li><code>indoor</code>: (BooleanField)</li> <li><code>toilets</code>: (BooleanField)</li> <li><code>handwashing</code>: (BooleanField)</li> <li><code>drinking_water</code>: (BooleanField)</li> </ul> </li> <li>Servicios<ul> <li><code>food</code>: (BooleanField)</li> <li><code>drinks</code>: (BooleanField)</li> <li><code>handicrafts</code>: (BooleanField)</li> <li><code>butcher</code>: (BooleanField)</li> <li><code>dairy</code>: (BooleanField)</li> <li><code>seafood</code>: (BooleanField)</li> <li><code>garden_centre</code>: (BooleanField)</li> <li><code>florist</code>: (BooleanField)</li> </ul> </li> <li>Otros<ul> <li><code>payment</code>: (ManyToManyField)</li> <li><code>other_services</code>: (CharField)</li> </ul> </li> <li> <p>Productos</p> <ul> <li><code>products</code>: (ManyToManyField)</li> </ul> </li> <li> <p><code>class Photo</code></p> </li> <li><code>marketplace</code>: (ForeignKey(Marketplace))</li> <li><code>image</code>: (ImageField)</li> <li><code>description</code>: (CharField)</li> <li><code>profile</code>: (BooleanField)</li> <li> <p><code>cover</code>: (BooleanField)</p> </li> <li> <p><code>class Payment</code></p> </li> <li><code>name</code>: (CharField)</li> </ul>"},{"location":"MODELS/#productos","title":"Productos","text":"<ul> <li><code>class Product</code></li> <li><code>product_id</code>: (AutoField) llave primaria, autogenerada.</li> <li><code>category</code>: (IntegerField) clasificaci\u00f3n por categor\u00eda de planta comestible, donde:<ul> <li>1: cereales</li> <li>2: legumbres</li> <li>3: frutas</li> <li>4: hortalizas</li> <li>5: condimentos  </li> </ul> </li> <li><code>product_url</code>: (CharField) caracteres creados a partir del nombre com\u00fan para usar en la URL. Ejemplo: https://feria.cr/productos/cebolla</li> <li><code>scientific_name</code>: (CharField) nomenclatura binomial seg\u00fan el C\u00f3digo Internacional de Nomenclatura. Ejemplo: Allium sativum.</li> <li><code>scientific_name_variety</code>: (CharField) variedad de una especie. Ejemplo: Allium ampeloprasum var. porrum (incluir solamente la variedad en este campo).</li> <li><code>common_name</code>: (CharField) nombre com\u00fan en Costa Rica. Ejemplo: lim\u00f3n.</li> <li><code>common_name_variety</code>: (CharField) nombre com\u00fan de la variedad en Costa Rica. Ejemplo: mecino.</li> <li><code>common_name_alternate</code>: (CharField) otros nombres comunes de la variedad en Costa Rica. Ejemplo: \u00e1cido.</li> <li><code>image</code>: (ImageField) imagen del producto.</li> <li><code>icon</code>: (FileField) icono para representar el producto en algunos lugares del sitio web.</li> <li><code>center_origin</code>: (IntegerField) centro de origen hist\u00f3rico del producto seg\u00fan la clasificaci\u00f3n de Vavilov:<ul> <li>1: (I) Asia oriental</li> <li>2: (II) Subcontinente indio</li> <li>3: (IIa) Archipi\u00e9lago indo-malayo</li> <li>4: (III) Sureste y centro de Asia</li> <li>5: (IV) Asia Menor y Creciente F\u00e9rtil</li> <li>6: (V) Mediterr\u00e1neo</li> <li>7: (VI) Abisinia (actual Etiop\u00eda)</li> <li>8: (VII) Mesoam\u00e9rica</li> <li>9: (VIII) Regi\u00f3n andina tropical</li> <li>10: (VIIIa) Regi\u00f3n chilena</li> <li>11: (VIIIb) Regi\u00f3n brasile\u00f1a-paraguaya</li> </ul> </li> <li>Nota: para cada mes a continuaci\u00f3n existe la siguiente clasificaci\u00f3n de estacionalidad:<ul> <li>0: imposible o muy dif\u00edcil de encontrar el producto</li> <li>1: producto escaso</li> <li>2: producto abundante</li> <li>3: plena temporada de cosecha</li> </ul> </li> <li><code>jan</code>: (IntegerField) estacionalidad en enero.</li> <li><code>feb</code>: (IntegerField) estacionalidad en febrero.</li> <li><code>mar</code>: (IntegerField) estacionalidad en marzo.</li> <li><code>apr</code>: (IntegerField) estacionalidad en abril.</li> <li><code>may</code>: (IntegerField) estacionalidad en mayo.</li> <li><code>jun</code>: (IntegerField) estacionalidad en junio.</li> <li><code>jul</code>: (IntegerField) estacionalidad en julio.</li> <li><code>aug</code>: (IntegerField) estacionalidad en agosto.</li> <li><code>sep</code>: (IntegerField) estacionalidad en septiembre.</li> <li><code>oct</code>: (IntegerField) estacionalidad en octubre.</li> <li><code>nov</code>: (IntegerField) estacionalidad en noviembre.</li> <li><code>dec</code>: (IntegerField) estacionalidad en diciembre.</li> <li> <p><code>nutritional_description</code>: (TextField) comentario sobre su valor nutricional.</p> </li> <li> <p><code>class Preparation</code></p> </li> <li><code>product_id</code>: (ForeignKey) llave for\u00e1nea con la tabla de productos.</li> <li><code>method</code>: (IntegerField) selecci\u00f3n de una lista de m\u00e9todos de preparaci\u00f3n de alimentos:<ul> <li>1: hervir</li> </ul> </li> <li><code>recommendation</code>: (IntegerField) nivel de recomendaci\u00f3n (?):<ul> <li>1: preparaci\u00f3n m\u00e1s saludable</li> <li>2: no s\u00e9 qu\u00e9</li> </ul> </li> <li> <p><code>description</code>: (TextField) descripci\u00f3n del m\u00e9todo con este producto.</p> </li> <li> <p><code>class Storage</code></p> </li> <li><code>product_id</code>: (ForeignKey) llave for\u00e1nea con la tabla de productos.</li> <li><code>method</code>: (IntegerField) selecci\u00f3n de una lista de m\u00e9todos de almacenamiento de alimentos:<ul> <li>1: a temperatura ambiente</li> <li>2: refrigerar</li> <li>3: congelar</li> </ul> </li> <li><code>recommendation</code>: (IntegerField) nivel de recomendaci\u00f3n (?):<ul> <li>1: preparaci\u00f3n m\u00e1s saludable</li> <li>2: no s\u00e9 qu\u00e9</li> </ul> </li> <li><code>description</code>: (TextField) descripci\u00f3n del m\u00e9todo con este producto.</li> </ul>"},{"location":"Manual_env/","title":"Configuraci\u00f3n del sitio","text":"<p>Estos son algunos consejos e instrucciones para usar el proyecto localmente o en el servidor.</p> <p>[!TIP] Se recomienda hacer uso del contenedor de Docker para el desarrollo de la aplicaci\u00f3n, ya que este manual podr\u00eda no ser tan detallado o no estar actualizado.</p> <p>[!WARNING] Es ideal no saltarse pasos de esta gu\u00eda, y de ser necesario, solicitar ayuda.</p>"},{"location":"Manual_env/#clave-secreta-de-django","title":"Clave secreta de Django","text":"<p>La clave secreta de Django y otras configuraciones est\u00e1n en un archivo <code>.env</code> y es manipulado por el paquete <code>python-decouple</code> (documentaci\u00f3n).</p>"},{"location":"Manual_env/#ambiente-virtual","title":"Ambiente virtual","text":"<p>Para desarrollar el proyecto de forma local se recomienda crear un ambiente virtual de python. Esto se puede realizar con los siguientes comandos:</p> <pre><code>ferias: $ python -m venv feriasenv\n</code></pre> <p>Activarlo con:</p> <pre><code>source feriasenv/bin/activate\n</code></pre> <p>y desactivarlo con:</p> <pre><code>deactivate\n</code></pre> <p>Para iniciar, instalar todos los paquetes especificados en el archivo <code>requirements.txt</code>, con:</p> <pre><code>pip install -r requirements.txt\n</code></pre> <p>Se agrega el archivo <code>.env</code> al directorio ra\u00edz. Nota: (en caso de ser necesario) al descargar el archivo <code>.env</code> y pasarlo al directorio ra\u00edz puede salir como <code>.env.env</code> se debe cambiar esto a solo <code>.env</code>.</p> <p>(Seguir instrucciones de la documentaci\u00f3n).</p> <p>El equipo de desarrolladores compartir\u00e1 el documento <code>.env</code>.</p> <p>Luego, se deben instalar los paquetes necesarios para el proyecto. Para hacer esto, en una terminal desde la ra\u00edz del proyecto, ejecute el siguiente comando:</p> <pre><code>pip install -r requirements.txt\n</code></pre>"},{"location":"Manual_env/#crear-base-de-datos-y-migrar-a-geodjango","title":"Crear base de datos y migrar a GeoDjango","text":"<p>El proyecto utiliza PostgreSQL. Una vez instalado puede ser controlado en terminal con <code>psql</code>, por ejemplo: <code>psql ferias</code> para entrar al CLI de la base de datos y hacer queries o modificar las tablas directamente. Nota: mucho cuidado con esto porque puede interferir con las migraciones de Django y causar problemas. </p> <p>GeoDjango es la extensi\u00f3n de Django para trabajar con datos geoespaciales. Ser\u00e1 utilizado con PostgreSQL y PostGIS.</p> <p>Los pasos de creaci\u00f3n de la base de datos son:</p> <ol> <li>Instalar PostgreSQL en la m\u00e1quina seg\u00fan el OS.</li> <li>Instalar PostGIS en la m\u00e1quina seg\u00fan el OS.</li> <li>Crear base de datos <code>ferias</code> con <code>$ createdb ferias</code>.</li> <li>Ingresar a la base de datos con <code>$ psql ferias</code>.</li> <li>Habilitar PostGIS para la base de datos <code>ferias</code> en <code>psql</code> con <code># CREATE EXTENSION postgis;</code>.</li> <li>Habilitar la b\u00fasqueda por trigram similarity en <code>psql ferias</code> con <code>CREATE EXTENSION IF NOT EXISTS pg_trgm;</code></li> <li>Habilitar la b\u00fasqueda sin acentos en <code>psql ferias</code> con <code>CREATE EXTENSION IF NOT EXISTS unaccent;</code></li> <li>En algunos sistemas operativos (Windows y macOS Apple Silicon s\u00ed, Linux y macOS Intel no), es necesario adjuntar a <code>settings.py</code> las ubicaciones de GDAL y GEOS (esto se hace autom\u00e1ticamente), y tambi\u00e9n en el archivo <code>.env</code> tal y como se puede apreciar en el archivo de ejemplo.</li> </ol> <p>En <code>settings.py</code> se encuentra configurado lo necesario para la base de datos, no es necesario modificarlo ya que toma los valores del archivo <code>.env</code>:</p> <pre><code>DATABASES = {\n    \"default\": {\n        \"ENGINE\": \"django.contrib.gis.db.backends.postgis\",\n        \"NAME\": config('DB_NAME'),\n        \"USER\": config('DB_USER'),\n    },\n}\n\nINSTALLED_APPS = [\n    (...)\n    \"django.contrib.postgres\",\n    \"django.contrib.gis\",\n]\n</code></pre>"},{"location":"Manual_env/#migraciones","title":"Migraciones","text":"<ul> <li>Hacer todas las migraciones con <code>$ python manage.py makemigrations marketplaces</code> y as\u00ed para cada app (products, crowdsourcing, website, etc.)</li> <li>Migrar con <code>$ python manage.py migrate</code> para crear las tablas.</li> <li>Hacer <code>$ python manage.py loaddata auth</code> para cargar los datos de usuarios de prueba del fixture (peligroso).</li> <li>Hacer <code>$ python manage.py loaddata marketplaces</code> para cargar los datos de las ferias del fixture (peligroso).</li> <li>Hacer <code>$ python manage.py loaddata products</code> para cargar los datos de los productos del fixture (peligroso).</li> <li>(etc.)</li> </ul> <p>Con esto deber\u00eda funcionar la aplicaci\u00f3n con PostgreSQL y PostGIS activado para usar GeoDjango, que permite guardar ubicaciones y regiones en el mapa y hacer b\u00fasquedas geoespaciales.</p> <p>[!NOTE] Dentro de la carpeta scripts hay archivos que permiten automatizar las migraciones previamente mencionadas.</p>"},{"location":"Manual_env/#destruir-la-base-de-datos","title":"Destruir la base de datos","text":"<p>En caso de pruebas y de ser necesario:</p> <ul> <li><code>$ psql postgres</code></li> <li><code># DROP DATABASE ferias;</code></li> <li></li> <li>Borrar todos los archivos de migraciones de todas las apps antes de intentar hacer las migraciones de nuevo</li> </ul>"},{"location":"Manual_env/#ejecutar-el-proyecto-de-forma-local","title":"Ejecutar el proyecto de forma local","text":"<p>Para ejecutar el proyecto se utiliza el comando:</p> <pre><code>python manage.py runserver\n</code></pre> <p>Para acceder al sitio en desarrollo se realiza mediante <code>localhost</code> en el puerto seleccionado, t\u00edpicamente <code>http://127.0.0.1:8000/</code>.</p>"},{"location":"Manual_env/#como-actualizar-el-servidor","title":"C\u00f3mo actualizar el servidor","text":"<ul> <li>Hacer cambios en una rama dedicada para tal fin</li> <li>Probar los cambios y fusionar (o hacer PR) con <code>main</code></li> <li>Luego hacer una fusi\u00f3n con <code>server</code> que es la rama en el servidor</li> <li>Entrar al servidor con SSH al usuario <code>tcu</code></li> <li>Si no hay cambios en los esquemas de la base de datos:</li> <li><code>cd ferias/</code></li> <li><code>git status</code></li> <li><code>git stash</code> (opcional, para \"poner al lado\" cualquier modificaci\u00f3n hecha en el servidor, que idealmente no deber\u00edan existir, excepto para \"remiendos\" temporales)</li> <li><code>git pull</code></li> <li><code>sudo systemctl restart nginx</code></li> <li><code>sudo systemctl restart gunicorn</code></li> <li>Si s\u00ed hay cambios en los esquemas de la base de datos (en alg\u00fan <code>models.py</code>)</li> <li><code>cd ferias/</code></li> <li><code>git status</code></li> <li><code>git stash</code></li> <li><code>git pull</code></li> <li>Entrar al ambiente virtual: <code>source feriasenv/bin/activate</code></li> <li>Por prevenci\u00f3n, se puede hacer una descarga de las tablas que van a ser modificadas, con <code>python manage.py dumpdata &lt;app&gt;.&lt;model&gt;</code> para guardar en el fixture <code>&lt;app&gt;.json</code> o <code>&lt;app&gt;_&lt;model&gt;.json</code>. Esto es importante porque las migraciones pueden salir mal.</li> <li>Hacer las migraciones de cada app: <code>python manage.py makemigrations &lt;app&gt;</code></li> <li>Migrar: <code>python manage.py migrate</code></li> <li>(Aqu\u00ed pueden pasar un mont\u00f3n de cosas tenebrosas con la base de datos)</li> <li>Salir del ambiente virtual: <code>deactivate</code></li> <li><code>sudo systemctl restart nginx</code></li> <li><code>sudo systemctl restart gunicorn</code></li> </ul> <p>Con suerte, vamos al navegador y probamos si funciona.</p>"},{"location":"Manual_env/#problemas-cargando-archivos-estaticos-por-error-403-forbidden","title":"Problemas cargando archivos est\u00e1ticos por error 403 Forbidden","text":"<p>Para servir archivos est\u00e1ticos en el servidor es necesario hacer lo usual:</p> <pre><code>(feriasenv) tcu@ubuntu-ferias:~/ferias python manage.py collectstatic\n</code></pre> <p>Sin embargo, puede haber problemas al cargar im\u00e1genes o CSS, JS, etc. con un error 403 Forbidden. Esto sucede t\u00edpicamente por permisos o la propiedad de los archivos. La soluci\u00f3n a la \u00faltima configuraci\u00f3n fue:</p> <pre><code>sudo gpasswd -a tcu www-data\n</code></pre> <p>Nota (24 de abril de 2024): la \u00faltima vez el comando fue <code>sudo gpasswd -a www-data bucr</code> (<code>bucr</code> es otro usuario, equivalente a <code>tcu</code>) y s\u00ed funcion\u00f3. En fin.</p> <p>que le da permisos al usuario <code>tcu</code> dentro de <code>www-data</code>.</p> <p>Es posible probar la asignaci\u00f3n con <code>getent group www-data</code>, que devolver\u00e1 algo como <code>www-data:x:33:tcu</code>. \u00bfQu\u00e9 es www-data?</p> <p>Luego de esto viene el reinicio usual de Nginx y Gunicorn (que no s\u00e9 si ser\u00e1 estrictamente necesario).</p> <p>Otra forma de resolver (cuando le da la gana) este problema es asignando manualmente y directamente los permisos a <code>www-data</code> para acceder a <code>staticfiles/</code>, as\u00ed:</p> <pre><code>sudo chown -R www-data:www-data /path/to/static/files\n</code></pre> <p>y luego:</p> <pre><code>sudo chown -R www-data:www-data /path/to/static/files\n</code></pre> <p>y finalmente reiniciando Nginx y Gunicorn.</p>"},{"location":"Manual_env/#aplicaciones-del-sitio","title":"Aplicaciones del sitio","text":"<p>Django utiliza \"apps\" para manejar el sitio. Por experiencia, sabemos que son divisiones \u00fatiles para la organizaci\u00f3n del sitio, aunque realmente desde una sola app se podr\u00edan realizar todas las funciones. Por orden, sin embargo, es mejor hacer una separaci\u00f3n funcional. En ese sentido, y con base en la funcionalidad esperada del sitio, se han creado los siguientes apps:</p> sitio Administra p\u00e1ginas generales, como el \"index\", acerca de, contacto, etc. datos Administra la base de datos de ferias. productos Administra la base de datos de productos ofrecidos en las ferias. informacion Administra las p\u00e1ginas de informaci\u00f3n para visitantes, como blogs, tutoriales, etc. crowdsourcing Administra la colaboraci\u00f3n colectiva para el mantenimiento y actualizaci\u00f3n de datos de las ferias y productos. api Administra un API p\u00fablico para que cualquier persona recopile datos de este proyecto. usuarios Administra los distintos tipos de usuarios del sitio."},{"location":"Manual_env/#paginas-del-sitio","title":"P\u00e1ginas del sitio","text":"<p>Con base en la funcionalidad descrita, es posible crear un primer esbozo de las p\u00e1ginas que tendr\u00e1 el sitio (arquitectura de informaci\u00f3n), clasificadas seg\u00fan el app que las gestiona:</p> <ul> <li>sitio<ul> <li><code>/</code>: p\u00e1gina de bienvenida</li> <li><code>/acerca</code>, <code>/contacto</code>, etc.: informaci\u00f3n sobre el sitio web</li> </ul> </li> <li>datos<ul> <li><code>/ferias</code>: p\u00e1gina de meta informaci\u00f3n sobre los datos que contiene la p\u00e1gina</li> <li><code>/ferias/&lt;c\u00f3digo-de-feria&gt;</code>: informaci\u00f3n b\u00e1sica de la feria</li> <li><code>/ferias/&lt;c\u00f3digo-de-feria&gt;/edicion</code>: edici\u00f3n de la informaci\u00f3n</li> </ul> </li> <li>productos<ul> <li><code>/productos</code>: p\u00e1gina de meta informaci\u00f3n sobre los datos que contiene la p\u00e1gina</li> <li><code>/productos/&lt;c\u00f3digo-de-producto&gt;</code>: editor de datos del producto elegido</li> </ul> </li> <li>informacion<ul> <li><code>/informacion</code>: p\u00e1gina de bienvenida a la secci\u00f3n de informaci\u00f3n</li> <li><code>/blog</code>, <code>/articulo</code>, etc.: otros sitios</li> </ul> </li> <li>crowdsourcing<ul> <li><code>/colaboracion</code>: p\u00e1gina de bienvenida de la secci\u00f3n de colaboraci\u00f3n colectiva</li> <li><code>/colaboracion/</code>:</li> </ul> </li> <li>api<ul> <li><code>/api</code>: p\u00e1gina de bienvenida e informaci\u00f3n sobre el API el proyecto</li> </ul> </li> <li>usuarios<ul> <li><code>/usuarios</code>: p\u00e1gina de informaci\u00f3n de usuarios</li> <li><code>/usuarios/perfil</code>: p\u00e1gina de informaci\u00f3n de la persona usuaria</li> </ul> </li> </ul>"},{"location":"Manual_env/#mapa-del-sitio","title":"Mapa del sitio","text":"<pre><code>stateDiagram-v2\n    por : Portada\n    fer : Ferias\n    feX : Cada feria\n    fed : Editar info\n    pro : Productos\n    prX : Cada producto\n    inf : Informaci\u00f3n\n    blo : Blog\n    cro : Crowdsourcing\n    api : API\n    ace : Acerca de\n    reg : Registro\n    ing : Ingreso\n    ini : Inicio\n    per : Perfil\n    edi : Ediciones\n    state log &lt;&lt;choice&gt;&gt;\n    state usu &lt;&lt;choice&gt;&gt;\n    state men &lt;&lt;fork&gt;&gt;\n\n    [*] --&gt; por\n    por --&gt; fer\n    fer --&gt; feX\n    feX --&gt; fed\n    por --&gt; pro\n    pro --&gt; prX\n    por --&gt; inf\n    inf --&gt; blo\n    inf --&gt; cro\n    inf --&gt; api\n    por --&gt; ace\n    por --&gt; log\n    log --&gt; ini : Logueado\n    log --&gt; usu : No logueado\n    usu --&gt; ing : Registrado\n    usu --&gt; reg : No registrado\n    ing --&gt; ini\n    reg --&gt; ing\n    ini --&gt; men\n    men --&gt; per\n    men --&gt; edi</code></pre>"},{"location":"Manual_env/#anexos","title":"Anexos","text":""},{"location":"Manual_env/#como-instalar-postgresql-en-macos","title":"C\u00f3mo instalar PostgreSQL en macOS","text":"<p>Nota: en Ubuntu viene instalado por defecto.</p> <p>Con Homebrew:</p> <p><pre><code>brew update\n</code></pre> para tener la \u00faltima versi\u00f3n de Homebrew. Luego: <pre><code>brew install postgresql\n</code></pre> para instalar PostgreSQL. Para activarlo, es necesario hacer: <pre><code>brew services start postgresql\n</code></pre> Nota: es posible que sea <code>brew services start postgresql@14</code>. Y finalmente es posible comprobar su funcionamiento con: <pre><code>brew services list\n</code></pre> Ahora hay que instalar PostGIS, con: <pre><code>brew install postgis\n</code></pre> Luego es posible seguir el procedimiento de migraci\u00f3n a GeoDjango indicado arriba.</p>"},{"location":"Manual_env/#problemas-con-gdal","title":"Problemas con GDAL","text":"<p>A veces GDAL da problemas. (GDAL sirve para PostGIS). Con la reciente actualizaci\u00f3n de Homebrew, algo estaba saliendo mal, que dec\u00eda tipo:</p> <pre><code>...\nfrom django.contrib.gis.gdal.prototypes import ds as vcapi\n...\nReason: tried: '/opt/homebrew/opt/hdf5/lib/libhdf5_hl.200.dylib' (no such file) ... '/usr/lib/libhdf5_hl.200.dylib' (no such file, not in dyld cache)\n</code></pre> <p>La soluci\u00f3n (aparentemente riesgosa) fue hacer:</p> <pre><code>brew reinstall gdal --build-from-source\n</code></pre> <p>que parece que sab\u00edan sus creadores de OSGEO. </p>"},{"location":"SITEMAP/","title":"Mapa del sitio","text":"<pre><code>flowchart TD\n    inicio(Inicio)\n    sobre(Sobre el proyecto)\n    sobre_ferias(Sobre las ferias)\n    ferias(Todas las ferias)\n    feria(Cada feria)\n    productos(Todos los productos)\n    producto(Cada producto)\n    informacion(Informaci\u00f3n de productos)\n    sugerencias(Sugerencias)\n    sugerencias_ferias(Todas las ferias)\n    sugerencias_feria(Cada feria)\n    sugerencias_productos(Todos los productos)\n    sugerencias_producto(Cada producto)\n    revisiones(Revisiones)\n    revisiones_ferias(Todas las ferias)\n    revisiones_feria(Cada feria)\n    revisiones_productos(Todos los productos)\n    revisiones_producto(Cada producto)\n\n    inicio --&gt; sobre\n    inicio --&gt; ferias\n    inicio --&gt; productos\n    inicio --&gt; sugerencias\n    sobre --&gt; sobre_ferias\n    ferias --&gt; feria\n    productos --&gt; producto\n    productos --&gt; informacion\n    sugerencias --&gt; sugerencias_ferias\n    sugerencias --&gt; sugerencias_productos\n    sugerencias --&gt; revisiones\n    sugerencias_ferias --&gt; sugerencias_feria\n    sugerencias_productos --&gt; sugerencias_producto\n    revisiones --&gt; revisiones_ferias\n    revisiones --&gt; revisiones_productos\n    revisiones_ferias --&gt; revisiones_feria\n    revisiones_productos --&gt; revisiones_producto</code></pre> <p> P\u00e1gina de inicio <code>/</code> (\"inicio\") app: <code>website</code></p> <p>P\u00e1gina de bienvenida al sitio con buscador, caracter\u00edsticas de las ferias. Pendiente: tipo \"portada de peri\u00f3dico\", con vistazo a los datos, la informaci\u00f3n, los art\u00edculos de blog, redes sociales, etc.</p> <p> Sobre el proyecto <code>/sobre/</code> (\"sobre\") app: <code>website</code></p> <p>P\u00e1gina de informaci\u00f3n sobre el proyecto, incluyendo la coordinaci\u00f3n, las personas que trabajaron, colaboradores, etc.</p> <p> Sobre las ferias del agricultor <code>/sobre/ferias/</code> (\"sobre_ferias\") app: <code>website</code></p> <p>P\u00e1gina de informaci\u00f3n sobre las ferias del agricultor, incluyendo historia, legislaci\u00f3n, etc.</p> <p> Todas las ferias <code>/ferias/</code> (\"ferias\") app: <code>marketplaces</code></p> <p>Datos generales de las ferias (ubicaci\u00f3n, ferias por provincia, d\u00edas de la semana, amenidades, infraestructura), el buscador de ferias y la lista de las ferias (nombre con link m\u00e1s provincia)</p> <p> P\u00e1gina de cada feria <code>/ferias/&lt;marketplace_url&gt;/</code> (\"feria\") app: <code>marketplaces</code></p> <p>Para cada feria: horario, direcci\u00f3n y mapa. Lista de amenidades e infraestructura. Otras ferias cercanas. Informaci\u00f3n de contacto.</p> <p> Todos los productos <code>/productos/</code> (\"productos\") app: <code>products</code></p> <p>Lista de todos los productos seg\u00fan categor\u00eda: frutas, verduras, tub\u00e9rculos y ra\u00edces, legumbres, hierbas y otros.</p> <p> P\u00e1gina de cada producto <code>/productos/&lt;product_url&gt;/</code> (\"producto\") app: <code>products</code></p> <p>Para cada producto: icono, nombre, nombres alternativos, categor\u00eda, canasta b\u00e1sica recomendada, descripci\u00f3n, variedades, rese\u00f1a nutricional, m\u00e9todos de preparaci\u00f3n, m\u00e9todos de almacenamiento, centro de origen, estacionalidad.</p> <p> P\u00e1gina de informaci\u00f3n de productos <code>/productos/informacion</code> (\"informacion\") app: <code>products</code></p> <p>Ampliaci\u00f3n de las informaciones sobre categor\u00edas, centro de origen y estacionalidad. Pendiente: p\u00e1ginas para la canasta b\u00e1sica recomendada, para m\u00e9todos de preparaci\u00f3n y almacenamiento. Podr\u00eda ser aqu\u00ed mismo, pero tambi\u00e9n podr\u00eda convertirse en una p\u00e1gina muy grande. Tambi\u00e9n alguna informaci\u00f3n de aqu\u00ed puede aparecer en \"modales\" dentro de la p\u00e1gina de cada producto, para f\u00e1cil acceso.</p> <p> Sugerencias para ferias y productos <code>/sugerencias/</code> (\"sugerencias\") app: <code>crowdsourcing</code></p> <p>P\u00e1gina de bienvenida a la secci\u00f3n de colaboraci\u00f3n colectiva, con una lista de todas las ferias y productos donde se puede colaborar con datos.</p> <p> Sugerencias para ferias <code>/sugerencias/ferias/</code> (\"sugerencias_ferias\") app: <code>crowdsourcing</code></p> <p>Lista de todas las ferias donde se puede colaborar con datos.</p> <p> Sugerencias para cada feria <code>/sugerencias/ferias/&lt;marketplace_url&gt;/</code> (\"producto\") app: <code>crowdsourcing</code></p> <p>Formulario con los datos que se pueden aportar de cada feria.</p> <p> Sugerencias para productos <code>/sugerencias/productos/</code> (\"sugerencias_productos\") app: <code>crowdsourcing</code></p> <p>Lista de todos los productos donde se puede colaborar con datos.</p> <p> Sugerencias para cada producto <code>/sugerencias/productos/&lt;product_url&gt;/</code> (\"sugerencias_producto\") app: <code>crowdsourcing</code></p> <p>Formulario con los datos que se pueden aportar de cada producto.</p> <p> Revisi\u00f3n de sugerencias para ferias y productos <code>/sugerencias/revisiones/</code> (\"revisiones\") app: <code>crowdsourcing</code></p> <p>P\u00e1gina de bienvenida a la secci\u00f3n de colaboraci\u00f3n colectiva, con una lista de todas las ferias y productos donde se puede colaborar con datos.</p> <p> Revisi\u00f3n de sugerencias para ferias <code>/sugerencias/revisiones/ferias/</code> (\"revisiones_ferias\") app: <code>crowdsourcing</code></p> <p>Lista de todas las ferias donde se puede revisar los datos.</p> <p> Revisi\u00f3n de sugerencias para cada feria <code>/sugerencias/revisiones/ferias/&lt;marketplace_url&gt;/</code> (\"revisiones_feria\") app: <code>crowdsourcing</code></p> <p>Formulario con la revisi\u00f3n de los datos que se pueden aportar de cada feria.</p> <p> Revisi\u00f3n de sugerencias para productos <code>/sugerencias/revisiones/productos/</code> (\"revisiones_productos\") app: <code>crowdsourcing</code></p> <p>Lista de todos los productos donde se puede revisar los datos.</p> <p> Revisi\u00f3n de sugerencias para cada producto <code>sugerencias/revisiones/productos/&lt;product_url&gt;/</code> (\"revisiones_producto\") app: <code>crowdsourcing</code></p> <p>Formulario con la revisi\u00f3n de los datos que se pueden aportar de cada producto.</p> <p> Ingresar a la cuenta del sitio <code>/ingresar/</code> (\"ingresar\") app: <code>website</code></p> <p>Formulario para ingreso a la cuenta.</p> <p> Salir de la cuenta del sitio <code>/salir/</code> (\"salir\") app: <code>website</code></p> <p>Salir del sitio (lleva al formulario de ingreso con un mensaje).</p>"},{"location":"SITEMAP/#primer-lanzamiento","title":"Primer lanzamiento","text":"<p>El primer lanzamiento del sitio tiene una versi\u00f3n nueva del formato y, sobre todo, de las p\u00e1ginas de cada feria y cada producto. Adem\u00e1s, tiene la funcionalidad de colaboraci\u00f3n colectiva, donde la gente puede hacer sugerencias y nosotros podemos revisar y actualizar los datos de cada feria y producto. No tiene la funcionalidad de blog, y est\u00e1 pensada, sobre todo, para revisi\u00f3n entre un n\u00famero limitado de personas.</p> <p>P\u00e1ginas:</p> <ul> <li>[ ] Inicio</li> <li>[ ] Sobre el proyecto</li> <li>[ ] Sobre las ferias</li> <li>[ ] Todas las ferias</li> <li>[ ] P\u00e1gina de cada feria</li> <li>[ ] Todos los productos</li> <li>[ ] P\u00e1gina de cada producto</li> <li>[ ] Informaci\u00f3n de los productos</li> <li>[ ] Sugerencias</li> <li>[ ] Sugerencias de ferias</li> <li>[ ] Sugerencias de cada feria</li> <li>[ ] Sugerencias de productos</li> <li>[ ] Sugerencias cada producto</li> <li>[ ] Revisi\u00f3n de sugerencias</li> <li>[ ] Revisi\u00f3n de sugerencias de ferias</li> <li>[ ] Revisi\u00f3n de sugerencias de cada feria</li> <li>[ ] Revisi\u00f3n de sugerencias de productos</li> <li>[ ] Revisi\u00f3n de sugerencias de cada producto</li> <li>[ ] Ingresar</li> <li>[ ] Salir</li> </ul>"},{"location":"SITEMAP/#segundo-lanzamiento","title":"Segundo lanzamiento","text":"<p>El segundo lanzamiento puede o no tener la funcionalidad de blog, pero ya los datos de ferias y productos estar\u00e1n revisados y el dise\u00f1o depurado.</p>"},{"location":"Stuff/","title":"Stuff","text":""},{"location":"Stuff/#principios-para-la-clasificacion-en-la-base-de-datos","title":"Principios para la clasificaci\u00f3n en la base de datos","text":"<ul> <li>Datos de las ferias: etiquetas de OpenStreetMaps</li> <li>Nombres cient\u00edficos de los productos: APG IV</li> <li>Centros de origen de los productos: Vavilov</li> <li>Campos de los productos: etiquetas inventadas pero en el formato de OpenStreetMaps</li> </ul>"},{"location":"Stuff/#cosas","title":"Cosas","text":"<ul> <li>Que al construir una b\u00fasqueda con distintos criterios, se vaya formando una frase, tipo:</li> </ul> <p>Quiero una feria cerca de m\u00ed que est\u00e9 abierta el viernes en la tarde, que sea mediana y con parqueo para bicicletas</p> <p>| Buscar |</p> <p>donde las palabras en negrita son los criterios de b\u00fasqueda. \u00bfPor qu\u00e9 esta frase? No deja dudas sobre lo que est\u00e1 buscando. (Alg\u00fan d\u00eda puede ser un dictado del usuario + NLP).</p> <p>Los criterios de b\u00fasqueda se pueden clasificar en cuatro: por ubicaci\u00f3n (\"cerca de m\u00ed\", \"cerca de X\"), por horario (\"abierto lunes en la ma\u00f1ana\", \"abierto viernes en la tarde\"), por caracter\u00edsticas (\"que sea mediana\", \"que est\u00e9 bajo techo\"), y por amenidades (\"con parqueo\", \"con comidas\").</p> <ul> <li> <p>La b\u00fasqueda debe resolver resultados aproximados y/o recomendados, es decir, que cumplan con la mayor\u00eda de caracter\u00edsticas</p> </li> <li> <p>Que una frase al pie de p\u00e1gina y de la campa\u00f1a sea </p> </li> </ul> <p>Dulce abrigo y sustento nos da</p>"},{"location":"api/","title":"De Feria API","text":""},{"location":"api/#funcionamiento","title":"Funcionamiento","text":""},{"location":"api/#workflow","title":"Workflow","text":"<p>Como se est\u00e1 utilizando Django Rest Framework, se va a seguir la estructura de la API que se describe en la documentaci\u00f3n de DRF. Todo empieza en el modelo de la aplicaci\u00f3n, que se va a definir en el archivo <code>models.py</code>. Luego, se va a crear un serializador en el archivo <code>serializers.py</code> que va a convertir los objetos de la base de datos en JSON. En este serializador se pueden escoger y dar formato a los datos que se quieren mostrar, por ejemplo, omitir algunos campos del modelo o empotrar datos de un modelo dentro del serializador de otro. Por \u00faltimo, se va a crear una vista en el archivo <code>views.py</code> que va a definir c\u00f3mo se va a ver la informaci\u00f3n en la API. Estas vistas se implementan mediante viewsets, que son clases que definen c\u00f3mo se van a ver los datos en la API. Por \u00faltimo, se va a definir la URL de la API en el archivo <code>urls.py</code> de la aplicaci\u00f3n.</p>"},{"location":"api/#documentacion-de-la-api","title":"Documentaci\u00f3n de la API","text":"<p>La documentaci\u00f3n de la API se va a generar autom\u00e1ticamente con la librer\u00eda <code>spectacular</code> y <code>redoc</code>. La librer\u00eda <code>spectacular</code> va a generar la documentaci\u00f3n de la API en formato JSON y <code>redoc</code> va a mostrar la documentaci\u00f3n en un formato m\u00e1s amigable. Para que esto suceda, <code>spectacular</code> debe generar un esquema de la API y <code>redoc</code> debe leer este esquema y mostrarlo en la URL <code>/api/docs/</code>. La informaci\u00f3n autogenerada por <code>spectacular</code> se puede modificar en el archivo <code>settings.py</code> en la secci\u00f3n <code>SPECTACULAR_SETTINGS</code>, o bien, (de forma m\u00e1s segura) utilizando la librer\u00eda <code>extend_schema</code>, para a\u00f1adir descripciones y mejorar la legibilidad de los m\u00e9todos b\u00e1sicos de la API (list, create, retrieve, update, partial update, delete).</p>"},{"location":"api/#actualizacion-y-generacion-de-la-documentacion","title":"Actualizaci\u00f3n y generaci\u00f3n de la documentaci\u00f3n","text":"<p>Existen limitaciones en la generaci\u00f3n de la documentaci\u00f3n de la API. Por ejemplo, no se pueden a\u00f1adir t\u00edtulos para la API o descripciones y licencias de la misma. Para solucionar esto, se ha decidio utilizar un documento .yaml que va a contener informaci\u00f3n est\u00e1tica sobre la API. Este documento se va a utilizar para generar el esquema definitivo que utilizar\u00e1 Redoc para mostrar la documentaci\u00f3n. </p> <p>Para actualizar la documentaci\u00f3n autogenerada, se debe correr este comando:</p> <pre><code>python manage.py spectacular --color --file api/schema.yml\n</code></pre> <p>Esto escribe el esquema autogenerado por <code>spectacular</code> en el archivo <code>api/schema.yml</code>. Luego, se debe ejecutar el comando:</p> <pre><code>python api/comb_schema_script.py\n</code></pre> <p>Este script combina el esquema autogenerado por <code>spectacular</code> con el esquema est\u00e1tico que se encuentra en el archivo <code>api/schema_static.yml</code>. Este archivo contiene informaci\u00f3n sobre la API que no se puede autogenerar, como t\u00edtulos, descripciones y licencias. El script combina estos dos archivos y escribe el esquema definitivo en el archivo <code>api/schema.yml</code>. Por \u00faltimo, se debe correr el servidor y acceder a la URL <code>/api/docs/</code> para ver la documentaci\u00f3n de la API.</p>"},{"location":"api/#ferias","title":"Ferias","text":"<p>Esta API va a permitir a los usuarios ver y (en caso de tener los permisos) modificar la informaci\u00f3n sobre las ferias. El formato esperado de esta API es el siguiente:</p> <pre><code>{\n    \"url\": \"http://127.0.0.1:8000/datos/api/ferias/alajuela/\",\n    \"name\": \"Alajuela\",\n    \"opening_hours\": \"Fr 12:00-20:00; Sa 06:00-13:00\",\n    \"location\": {\n        \"type\": \"Point\",\n        \"coordinates\": [\n            -84.2190568571068,\n            10.013534238571\n        ]\n    },\n    \"size\": \"XL\",\n    \"province\": \"Alajuela\",\n    \"canton\": \"Alajuela\",\n    \"district\": \"Alajuela\",\n    \"postal_code\": 20101,\n    \"address\": \"en Plaza Ferias. De la bomba Santa Anita, 200 m al oeste. Del PriceSmart de Alajuela, 250 m al este. Por Ekono\",\n    \"phone\": 24432010,\n    \"email\": \"pferias@plazaferias.com\",\n    \"website\": null,\n    \"facebook\": \"https://www.facebook.com/people/Plaza-Ferias-Alajuela/100064584170065/\",\n    \"instagram\": null,\n    \"opening_date\": null,\n    \"operator\": \"Plaza Ferias\",\n    \"branch\": null,\n    \"type\": \"mercado\",\n    \"parking\": \"surface\",\n    \"bicycle_parking\": true,\n    \"fairground\": true,\n    \"indoor\": true,\n    \"toilets\": true,\n    \"handwashing\": true,\n    \"drinking_water\": true,\n    \"food\": true,\n    \"drinks\": true,\n    \"handicrafts\": true,\n    \"butcher\": true,\n    \"dairy\": true,\n    \"seafood\": true,\n    \"spices\": null,\n    \"garden_centre\": true,\n    \"florist\": true,\n    \"other_services\": null\n}\n</code></pre> <p>Todos los atributos pueden estar en blanco o ser nulos excepto <code>url</code> (llave primaria), <code>name</code>, <code>province</code>, <code>canton</code> y <code>district</code>.</p>"},{"location":"api/#geoferias","title":"GeoFerias","text":"<p>Este API trata con los datos relativos a las ubicaciones de las ferias. Su objetivo es retornar un archivo geojson en lugar de un json normal. Esto porque el geojson se utiliza para tratar con datos geom\u00e9tricos y en este caso, geogr\u00e1ficos. El formato esperado de esta API es el siguiente:</p> <pre><code>{\n    \"type\": \"Feature\",\n    \"geometry\": {\n        \"type\": \"Point\",\n        \"coordinates\": [\n            -84.2190568571068,\n            10.013534238571\n        ]\n    },\n    \"properties\": {\n        \"name\": \"Alajuela\",\n        \"province\": \"Alajuela\",\n        \"canton\": \"Alajuela\",\n        \"district\": \"Alajuela\",\n        \"postal_code\": 20101,\n        \"address\": \"en Plaza Ferias. De la bomba Santa Anita, 200 m al oeste. Del PriceSmart de Alajuela, 250 m al este. Por Ekono\"\n    }\n}\n</code></pre> <p>Tiene los mismos atributos no nulos que la API de ferias, pero en este caso, se a\u00f1ade un atributo <code>geometry</code> que contiene la informaci\u00f3n de la ubicaci\u00f3n de la feria. Este es el atributo <code>location</code> en el modelo original y puede ser nulo, por lo que se debe tener esto en cuenta y manejar el caso en el futuro.</p>"},{"location":"api/#productos","title":"Productos","text":"<p>Este API trata con los diferentes tipos de productos que se pueden encontrar en las diferentes ferias a lo largo del pa\u00eds. Cada producto tiene asociado una variedad, dicha variedad puede tener nombre cient\u00edfico, nombre com\u00fan, disponibilidad por temporada, entre otros. El formato esperado de esta API es el siguiente:</p> <pre><code>{\n    \"product_url\": \"acelga\",\n    \"category\": \"verdura\",\n    \"common_name\": \"acelga\",\n    \"common_name_alternate\": null,\n    \"description\": \"La acelga, al igual que la espinaca, brilla en ensaladas, pues aporta frescura y un inmenso valor nutricional. Reconocida por su alto aporte en minerales y vitaminas esenciales, es la adici\u00f3n perfecta para una dieta equilibrada.\",\n    \"name_origin\": null,\n    \"center_origin\": [\n        \"VI\"\n    ],\n    \"center_origin_notes\": \"La cocina et\u00edope, rica en opciones vegetarianas, ha visto nacer a la acelga en sus tierras y ha sido la primera en acogerla como un ingrediente esencial en sus deliciosas recetas verdes.\",\n    \"food_basket\": false,\n    \"nutrition_notes\": \"La acelga, rica en vitaminas A, C y K y minerales esenciales para el buen funcionamiento del organismo, como magnesio, hierro y potasio, tambi\u00e9n ayuda a regular los procesos digestivos. Su elevado contenido de vitamina K ayuda a mantener sanos los huesos y la sangre.\",\n    \"preparation\": [],\n    \"preparation_notes\": null,\n    \"storage\": [],\n    \"storage_notes\": \"En un recipiente cerrado con poca humedad\",\n    \"varieties\": [\n        {\n            \"common_name_variety\": null,\n            \"scientific_name\": \"Beta vulgaris\",\n            \"scientific_name_variety\": \"cicla\",\n            \"common_name_variety_alternate\": null,\n            \"jan\": 3,\n            \"feb\": 3,\n            \"mar\": 3,\n            \"apr\": 2,\n            \"may\": 2,\n            \"jun\": 2,\n            \"jul\": 2,\n            \"aug\": 1,\n            \"sep\": 1,\n            \"oct\": 2,\n            \"nov\": 2,\n            \"dec\": 2\n        }\n    ]\n}\n</code></pre> <p>En este caso, los atribbutos que no pueden ser nullos son product_url, category, common name y variety_id, en el caso del modelo de variedades.</p>"},{"location":"api/#precios","title":"Precios","text":"<pre><code>{\n    \"product\" = \"aguacate Hass\"\n    \"prices-history\" = [\n\n    ]\n}\n</code></pre>"},{"location":"identidad/","title":"Identidad visual","text":"<p>La identidad de De Feria est\u00e1 definida por varios elementos:</p> <ul> <li>El nombre</li> <li>El logo</li> <li>La tipograf\u00eda</li> <li>La paleta de colores</li> <li>\u00cdconos de los productos</li> </ul>"},{"location":"identidad/#nombre","title":"Nombre","text":"<p>\"De feria\" es una alusi\u00f3n a frases comunes como:</p> <ul> <li>\"\u00a1Vamos de feria!\"</li> <li>\"Frescura, variedad y precios de feria\"</li> <li>\"Este jocote es de feria\": de gratis, extra</li> <li>\"Y tras de feria\": adicionalmente, para rematar, tras de todo</li> </ul> <p>La estilizaci\u00f3n de los nombres utilizados en el proyecto son, seg\u00fan el medio donde son usados:</p> <ul> <li>de feria / deferia / De Feria / DeFeria </li> <li>deferia.cr (URL del sitio web, usuario de Instagram y TikTok)</li> </ul> <p>(Los preferidos est\u00e1n en negrita).</p>"},{"location":"identidad/#logo","title":"Logo","text":"<p>Variedades de color</p> <p> </p> <p> Descargar logos (.zip)</p>"},{"location":"identidad/#tipografia","title":"Tipograf\u00eda","text":"<p>La identidad visual, incluyendo el sitio web, utiliza dos fuentes tipogr\u00e1ficas:</p> <ul> <li>Nunito Sans (Google Fonts): sans serif (palo seco) para textos y el logo.</li> </ul> <p>Un jugoso zumo de pi\u00f1a y kiwi bien fr\u00edo es exquisito y no lleva alcohol</p> <ul> <li>Petrona (Google Fonts): serifa para t\u00edtulos.</li> </ul> <p>Un jugoso zumo de pi\u00f1a y kiwi bien fr\u00edo es exquisito y no lleva alcohol</p>"},{"location":"identidad/#paleta-de-colores","title":"Paleta de colores","text":"<p>Paleta seleccionada para reflejar la riqueza visual de las ferias, con colores en tonos tierra pero con altos contrastes.</p> Nombre HEX RGB Muestra Amarillo EBB615 235, 181, 21 Verde 008D4A 0, 141, 74 Azul 3879B5 56, 121, 182 Gris D1C5BA 209, 197, 186 Rojo E64128 230, 65, 40 Caf\u00e9 CD7535 205, 117, 53 Rosado F29196 242, 145, 150 Negro 000000 0, 0, 0"},{"location":"identidad/#iconos","title":"\u00cdconos","text":"<p>Para complementar la identidad visual, fueron dise\u00f1ados una gran cantidad de \u00edconos para representar los productos de la feria en nuestra base de datos.</p> <p> Descargar \u00edconos (.zip)</p> <p> </p>"},{"location":"sobre/","title":"Sobre el proyecto","text":"<p>De Feria es un proyecto de trabajo comunal universitario de la Universidad de Costa Rica, desarrollado por TC-691 \"Tropicalizaci\u00f3n de la tecnolog\u00eda\" de la Escuela de Ingenier\u00eda El\u00e9ctrica, con la direcci\u00f3n del profesor Fabi\u00e1n Abarca Calder\u00f3n.</p> <p></p> <p>De Feria tiene el apoyo t\u00e9cnico y log\u00edstico de FAO Costa Rica.</p> <p></p> <p> M\u00e1s informaci\u00f3n del proyecto en el sitio web.</p>"},{"location":"sobre/#identidad-visual","title":"Identidad visual","text":"<p>Participaron en el dise\u00f1o de la identidad visual:</p> <ul> <li>Gabriel Alejandro Quir\u00f3s Villalobos, Direcci\u00f3n de Empresas (dise\u00f1o del logo)</li> <li>Katherine Priscilla Mora Cruz, Dise\u00f1o Gr\u00e1fico (paleta de colores, investigaci\u00f3n y primera versi\u00f3n del manual de identidad)</li> <li>Alexandra Alfaro Rodr\u00edguez, Dise\u00f1o Gr\u00e1fico (elementos de la identidad visual)</li> <li>Fabi\u00e1n Abarca Calder\u00f3n, Ingenier\u00eda El\u00e9ctrica (supervisi\u00f3n, dise\u00f1o de la p\u00e1gina web)</li> </ul>"}]}